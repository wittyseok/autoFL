[
    {
        "name": "test.test_YoutubeDL.YDL.__init__#26",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.YDL",
        "signature": "test.test_YoutubeDL.YDL.__init__(self, *args, **kwargs)",
        "snippet": "    def __init__(self, *args, **kwargs):\n        super(YDL, self).__init__(*args, **kwargs)\n        self.downloaded_info_dicts = []\n        self.msgs = []",
        "begin_line": 26,
        "end_line": 29,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.YDL.process_info#31",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.YDL",
        "signature": "test.test_YoutubeDL.YDL.process_info(self, info_dict)",
        "snippet": "    def process_info(self, info_dict):\n        self.downloaded_info_dicts.append(info_dict)",
        "begin_line": 31,
        "end_line": 32,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.YDL.to_screen#34",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.YDL",
        "signature": "test.test_YoutubeDL.YDL.to_screen(self, msg)",
        "snippet": "    def to_screen(self, msg):\n        self.msgs.append(msg)",
        "begin_line": 34,
        "end_line": 35,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL._make_result#38",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL",
        "signature": "test.test_YoutubeDL._make_result(formats, **kwargs)",
        "snippet": "def _make_result(formats, **kwargs):\n    res = {\n        'formats': formats,\n        'id': 'testid',\n        'title': 'testttitle',\n        'extractor': 'testex',\n    }\n    res.update(**kwargs)\n    return res",
        "begin_line": 38,
        "end_line": 46,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestFormatSelection.test_prefer_free_formats#50",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestFormatSelection",
        "signature": "test.test_YoutubeDL.TestFormatSelection.test_prefer_free_formats(self)",
        "snippet": "    def test_prefer_free_formats(self):\n        # Same resolution => download webm\n        ydl = YDL()\n        ydl.params['prefer_free_formats'] = True\n        formats = [\n            {'ext': 'webm', 'height': 460, 'url': TEST_URL},\n            {'ext': 'mp4', 'height': 460, 'url': TEST_URL},\n        ]\n        info_dict = _make_result(formats)\n        yie = YoutubeIE(ydl)\n        yie._sort_formats(info_dict['formats'])\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['ext'], 'webm')\n\n        # Different resolution => download best quality (mp4)\n        ydl = YDL()\n        ydl.params['prefer_free_formats'] = True\n        formats = [\n            {'ext': 'webm', 'height': 720, 'url': TEST_URL},\n            {'ext': 'mp4', 'height': 1080, 'url': TEST_URL},\n        ]\n        info_dict['formats'] = formats\n        yie = YoutubeIE(ydl)\n        yie._sort_formats(info_dict['formats'])\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['ext'], 'mp4')\n\n        # No prefer_free_formats => prefer mp4 and flv for greater compatibility\n        ydl = YDL()\n        ydl.params['prefer_free_formats'] = False\n        formats = [\n            {'ext': 'webm', 'height': 720, 'url': TEST_URL},\n            {'ext': 'mp4', 'height': 720, 'url': TEST_URL},\n            {'ext': 'flv', 'height': 720, 'url': TEST_URL},\n        ]\n        info_dict['formats'] = formats\n        yie = YoutubeIE(ydl)\n        yie._sort_formats(info_dict['formats'])\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['ext'], 'mp4')\n\n        ydl = YDL()\n        ydl.params['prefer_free_formats'] = False\n        formats = [\n            {'ext': 'flv', 'height': 720, 'url': TEST_URL},\n            {'ext': 'webm', 'height': 720, 'url': TEST_URL},\n        ]\n        info_dict['formats'] = formats\n        yie = YoutubeIE(ydl)\n        yie._sort_formats(info_dict['formats'])\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['ext'], 'flv')",
        "begin_line": 50,
        "end_line": 105,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestFormatSelection.test_format_selection#107",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestFormatSelection",
        "signature": "test.test_YoutubeDL.TestFormatSelection.test_format_selection(self)",
        "snippet": "    def test_format_selection(self):\n        formats = [\n            {'format_id': '35', 'ext': 'mp4', 'preference': 1, 'url': TEST_URL},\n            {'format_id': 'example-with-dashes', 'ext': 'webm', 'preference': 1, 'url': TEST_URL},\n            {'format_id': '45', 'ext': 'webm', 'preference': 2, 'url': TEST_URL},\n            {'format_id': '47', 'ext': 'webm', 'preference': 3, 'url': TEST_URL},\n            {'format_id': '2', 'ext': 'flv', 'preference': 4, 'url': TEST_URL},\n        ]\n        info_dict = _make_result(formats)\n\n        ydl = YDL({'format': '20/47'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], '47')\n\n        ydl = YDL({'format': '20/71/worst'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], '35')\n\n        ydl = YDL()\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], '2')\n\n        ydl = YDL({'format': 'webm/mp4'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], '47')\n\n        ydl = YDL({'format': '3gp/40/mp4'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], '35')\n\n        ydl = YDL({'format': 'example-with-dashes'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'example-with-dashes')",
        "begin_line": 107,
        "end_line": 145,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestFormatSelection.test_format_selection_audio#147",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestFormatSelection",
        "signature": "test.test_YoutubeDL.TestFormatSelection.test_format_selection_audio(self)",
        "snippet": "    def test_format_selection_audio(self):\n        formats = [\n            {'format_id': 'audio-low', 'ext': 'webm', 'preference': 1, 'vcodec': 'none', 'url': TEST_URL},\n            {'format_id': 'audio-mid', 'ext': 'webm', 'preference': 2, 'vcodec': 'none', 'url': TEST_URL},\n            {'format_id': 'audio-high', 'ext': 'flv', 'preference': 3, 'vcodec': 'none', 'url': TEST_URL},\n            {'format_id': 'vid', 'ext': 'mp4', 'preference': 4, 'url': TEST_URL},\n        ]\n        info_dict = _make_result(formats)\n\n        ydl = YDL({'format': 'bestaudio'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'audio-high')\n\n        ydl = YDL({'format': 'worstaudio'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'audio-low')\n\n        formats = [\n            {'format_id': 'vid-low', 'ext': 'mp4', 'preference': 1, 'url': TEST_URL},\n            {'format_id': 'vid-high', 'ext': 'mp4', 'preference': 2, 'url': TEST_URL},\n        ]\n        info_dict = _make_result(formats)\n\n        ydl = YDL({'format': 'bestaudio/worstaudio/best'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'vid-high')",
        "begin_line": 147,
        "end_line": 175,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestFormatSelection.test_format_selection_audio_exts#177",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestFormatSelection",
        "signature": "test.test_YoutubeDL.TestFormatSelection.test_format_selection_audio_exts(self)",
        "snippet": "    def test_format_selection_audio_exts(self):\n        formats = [\n            {'format_id': 'mp3-64', 'ext': 'mp3', 'abr': 64, 'url': 'http://_', 'vcodec': 'none'},\n            {'format_id': 'ogg-64', 'ext': 'ogg', 'abr': 64, 'url': 'http://_', 'vcodec': 'none'},\n            {'format_id': 'aac-64', 'ext': 'aac', 'abr': 64, 'url': 'http://_', 'vcodec': 'none'},\n            {'format_id': 'mp3-32', 'ext': 'mp3', 'abr': 32, 'url': 'http://_', 'vcodec': 'none'},\n            {'format_id': 'aac-32', 'ext': 'aac', 'abr': 32, 'url': 'http://_', 'vcodec': 'none'},\n        ]\n\n        info_dict = _make_result(formats)\n        ydl = YDL({'format': 'best'})\n        ie = YoutubeIE(ydl)\n        ie._sort_formats(info_dict['formats'])\n        ydl.process_ie_result(copy.deepcopy(info_dict))\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'aac-64')\n\n        ydl = YDL({'format': 'mp3'})\n        ie = YoutubeIE(ydl)\n        ie._sort_formats(info_dict['formats'])\n        ydl.process_ie_result(copy.deepcopy(info_dict))\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'mp3-64')\n\n        ydl = YDL({'prefer_free_formats': True})\n        ie = YoutubeIE(ydl)\n        ie._sort_formats(info_dict['formats'])\n        ydl.process_ie_result(copy.deepcopy(info_dict))\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'ogg-64')",
        "begin_line": 177,
        "end_line": 206,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestFormatSelection.test_format_selection_video#208",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestFormatSelection",
        "signature": "test.test_YoutubeDL.TestFormatSelection.test_format_selection_video(self)",
        "snippet": "    def test_format_selection_video(self):\n        formats = [\n            {'format_id': 'dash-video-low', 'ext': 'mp4', 'preference': 1, 'acodec': 'none', 'url': TEST_URL},\n            {'format_id': 'dash-video-high', 'ext': 'mp4', 'preference': 2, 'acodec': 'none', 'url': TEST_URL},\n            {'format_id': 'vid', 'ext': 'mp4', 'preference': 3, 'url': TEST_URL},\n        ]\n        info_dict = _make_result(formats)\n\n        ydl = YDL({'format': 'bestvideo'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'dash-video-high')\n\n        ydl = YDL({'format': 'worstvideo'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'dash-video-low')\n\n        ydl = YDL({'format': 'bestvideo[format_id^=dash][format_id$=low]'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'dash-video-low')\n\n        formats = [\n            {'format_id': 'vid-vcodec-dot', 'ext': 'mp4', 'preference': 1, 'vcodec': 'avc1.123456', 'acodec': 'none', 'url': TEST_URL},\n        ]\n        info_dict = _make_result(formats)\n\n        ydl = YDL({'format': 'bestvideo[vcodec=avc1.123456]'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'vid-vcodec-dot')",
        "begin_line": 208,
        "end_line": 239,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestFormatSelection.test_youtube_format_selection#241",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestFormatSelection",
        "signature": "test.test_YoutubeDL.TestFormatSelection.test_youtube_format_selection(self)",
        "snippet": "    def test_youtube_format_selection(self):\n        order = [\n            '38', '37', '46', '22', '45', '35', '44', '18', '34', '43', '6', '5', '17', '36', '13',\n            # Apple HTTP Live Streaming\n            '96', '95', '94', '93', '92', '132', '151',\n            # 3D\n            '85', '84', '102', '83', '101', '82', '100',\n            # Dash video\n            '137', '248', '136', '247', '135', '246',\n            '245', '244', '134', '243', '133', '242', '160',\n            # Dash audio\n            '141', '172', '140', '171', '139',\n        ]\n\n        def format_info(f_id):\n            info = YoutubeIE._formats[f_id].copy()\n\n            # XXX: In real cases InfoExtractor._parse_mpd_formats() fills up 'acodec'\n            # and 'vcodec', while in tests such information is incomplete since\n            # commit a6c2c24479e5f4827ceb06f64d855329c0a6f593\n            # test_YoutubeDL.test_youtube_format_selection is broken without\n            # this fix\n            if 'acodec' in info and 'vcodec' not in info:\n                info['vcodec'] = 'none'\n            elif 'vcodec' in info and 'acodec' not in info:\n                info['acodec'] = 'none'\n\n            info['format_id'] = f_id\n            info['url'] = 'url:' + f_id\n            return info\n        formats_order = [format_info(f_id) for f_id in order]\n\n        info_dict = _make_result(list(formats_order), extractor='youtube')\n        ydl = YDL({'format': 'bestvideo+bestaudio'})\n        yie = YoutubeIE(ydl)\n        yie._sort_formats(info_dict['formats'])\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], '137+141')\n        self.assertEqual(downloaded['ext'], 'mp4')\n\n        info_dict = _make_result(list(formats_order), extractor='youtube')\n        ydl = YDL({'format': 'bestvideo[height>=999999]+bestaudio/best'})\n        yie = YoutubeIE(ydl)\n        yie._sort_formats(info_dict['formats'])\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], '38')\n\n        info_dict = _make_result(list(formats_order), extractor='youtube')\n        ydl = YDL({'format': 'bestvideo/best,bestaudio'})\n        yie = YoutubeIE(ydl)\n        yie._sort_formats(info_dict['formats'])\n        ydl.process_ie_result(info_dict)\n        downloaded_ids = [info['format_id'] for info in ydl.downloaded_info_dicts]\n        self.assertEqual(downloaded_ids, ['137', '141'])\n\n        info_dict = _make_result(list(formats_order), extractor='youtube')\n        ydl = YDL({'format': '(bestvideo[ext=mp4],bestvideo[ext=webm])+bestaudio'})\n        yie = YoutubeIE(ydl)\n        yie._sort_formats(info_dict['formats'])\n        ydl.process_ie_result(info_dict)\n        downloaded_ids = [info['format_id'] for info in ydl.downloaded_info_dicts]\n        self.assertEqual(downloaded_ids, ['137+141', '248+141'])\n\n        info_dict = _make_result(list(formats_order), extractor='youtube')\n        ydl = YDL({'format': '(bestvideo[ext=mp4],bestvideo[ext=webm])[height<=720]+bestaudio'})\n        yie = YoutubeIE(ydl)\n        yie._sort_formats(info_dict['formats'])\n        ydl.process_ie_result(info_dict)\n        downloaded_ids = [info['format_id'] for info in ydl.downloaded_info_dicts]\n        self.assertEqual(downloaded_ids, ['136+141', '247+141'])\n\n        info_dict = _make_result(list(formats_order), extractor='youtube')\n        ydl = YDL({'format': '(bestvideo[ext=none]/bestvideo[ext=webm])+bestaudio'})\n        yie = YoutubeIE(ydl)\n        yie._sort_formats(info_dict['formats'])\n        ydl.process_ie_result(info_dict)\n        downloaded_ids = [info['format_id'] for info in ydl.downloaded_info_dicts]\n        self.assertEqual(downloaded_ids, ['248+141'])\n\n        for f1, f2 in zip(formats_order, formats_order[1:]):\n            info_dict = _make_result([f1, f2], extractor='youtube')\n            ydl = YDL({'format': 'best/bestvideo'})\n            yie = YoutubeIE(ydl)\n            yie._sort_formats(info_dict['formats'])\n            ydl.process_ie_result(info_dict)\n            downloaded = ydl.downloaded_info_dicts[0]\n            self.assertEqual(downloaded['format_id'], f1['format_id'])\n\n            info_dict = _make_result([f2, f1], extractor='youtube')\n            ydl = YDL({'format': 'best/bestvideo'})\n            yie = YoutubeIE(ydl)\n            yie._sort_formats(info_dict['formats'])\n            ydl.process_ie_result(info_dict)\n            downloaded = ydl.downloaded_info_dicts[0]\n            self.assertEqual(downloaded['format_id'], f1['format_id'])",
        "begin_line": 241,
        "end_line": 337,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestFormatSelection.format_info#255",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestFormatSelection",
        "signature": "test.test_YoutubeDL.TestFormatSelection.format_info(f_id)",
        "snippet": "        def format_info(f_id):\n            info = YoutubeIE._formats[f_id].copy()\n\n            # XXX: In real cases InfoExtractor._parse_mpd_formats() fills up 'acodec'\n            # and 'vcodec', while in tests such information is incomplete since\n            # commit a6c2c24479e5f4827ceb06f64d855329c0a6f593\n            # test_YoutubeDL.test_youtube_format_selection is broken without\n            # this fix\n            if 'acodec' in info and 'vcodec' not in info:\n                info['vcodec'] = 'none'\n            elif 'vcodec' in info and 'acodec' not in info:\n                info['acodec'] = 'none'\n\n            info['format_id'] = f_id\n            info['url'] = 'url:' + f_id\n            return info",
        "begin_line": 255,
        "end_line": 270,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestFormatSelection.test_audio_only_extractor_format_selection#339",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestFormatSelection",
        "signature": "test.test_YoutubeDL.TestFormatSelection.test_audio_only_extractor_format_selection(self)",
        "snippet": "    def test_audio_only_extractor_format_selection(self):\n        # For extractors with incomplete formats (all formats are audio-only or\n        # video-only) best and worst should fallback to corresponding best/worst\n        # video-only or audio-only formats (as per\n        # https://github.com/rg3/youtube-dl/pull/5556)\n        formats = [\n            {'format_id': 'low', 'ext': 'mp3', 'preference': 1, 'vcodec': 'none', 'url': TEST_URL},\n            {'format_id': 'high', 'ext': 'mp3', 'preference': 2, 'vcodec': 'none', 'url': TEST_URL},\n        ]\n        info_dict = _make_result(formats)\n\n        ydl = YDL({'format': 'best'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'high')\n\n        ydl = YDL({'format': 'worst'})\n        ydl.process_ie_result(info_dict.copy())\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'low')",
        "begin_line": 339,
        "end_line": 358,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestFormatSelection.test_format_not_available#360",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestFormatSelection",
        "signature": "test.test_YoutubeDL.TestFormatSelection.test_format_not_available(self)",
        "snippet": "    def test_format_not_available(self):\n        formats = [\n            {'format_id': 'regular', 'ext': 'mp4', 'height': 360, 'url': TEST_URL},\n            {'format_id': 'video', 'ext': 'mp4', 'height': 720, 'acodec': 'none', 'url': TEST_URL},\n        ]\n        info_dict = _make_result(formats)\n\n        # This must fail since complete video-audio format does not match filter\n        # and extractor does not provide incomplete only formats (i.e. only\n        # video-only or audio-only).\n        ydl = YDL({'format': 'best[height>360]'})\n        self.assertRaises(ExtractorError, ydl.process_ie_result, info_dict.copy())",
        "begin_line": 360,
        "end_line": 371,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestFormatSelection.test_invalid_format_specs#373",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestFormatSelection",
        "signature": "test.test_YoutubeDL.TestFormatSelection.test_invalid_format_specs(self)",
        "snippet": "    def test_invalid_format_specs(self):\n        def assert_syntax_error(format_spec):\n            ydl = YDL({'format': format_spec})\n            info_dict = _make_result([{'format_id': 'foo', 'url': TEST_URL}])\n            self.assertRaises(SyntaxError, ydl.process_ie_result, info_dict)\n\n        assert_syntax_error('bestvideo,,best')\n        assert_syntax_error('+bestaudio')\n        assert_syntax_error('bestvideo+')\n        assert_syntax_error('/')",
        "begin_line": 373,
        "end_line": 382,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestFormatSelection.assert_syntax_error#374",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestFormatSelection",
        "signature": "test.test_YoutubeDL.TestFormatSelection.assert_syntax_error(format_spec)",
        "snippet": "        def assert_syntax_error(format_spec):\n            ydl = YDL({'format': format_spec})\n            info_dict = _make_result([{'format_id': 'foo', 'url': TEST_URL}])\n            self.assertRaises(SyntaxError, ydl.process_ie_result, info_dict)",
        "begin_line": 374,
        "end_line": 377,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestFormatSelection.test_format_filtering#384",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestFormatSelection",
        "signature": "test.test_YoutubeDL.TestFormatSelection.test_format_filtering(self)",
        "snippet": "    def test_format_filtering(self):\n        formats = [\n            {'format_id': 'A', 'filesize': 500, 'width': 1000},\n            {'format_id': 'B', 'filesize': 1000, 'width': 500},\n            {'format_id': 'C', 'filesize': 1000, 'width': 400},\n            {'format_id': 'D', 'filesize': 2000, 'width': 600},\n            {'format_id': 'E', 'filesize': 3000},\n            {'format_id': 'F'},\n            {'format_id': 'G', 'filesize': 1000000},\n        ]\n        for f in formats:\n            f['url'] = 'http://_/'\n            f['ext'] = 'unknown'\n        info_dict = _make_result(formats)\n\n        ydl = YDL({'format': 'best[filesize<3000]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'D')\n\n        ydl = YDL({'format': 'best[filesize<=3000]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'E')\n\n        ydl = YDL({'format': 'best[filesize <= ? 3000]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'F')\n\n        ydl = YDL({'format': 'best [filesize = 1000] [width>450]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'B')\n\n        ydl = YDL({'format': 'best [filesize = 1000] [width!=450]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'C')\n\n        ydl = YDL({'format': '[filesize>?1]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'G')\n\n        ydl = YDL({'format': '[filesize<1M]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'E')\n\n        ydl = YDL({'format': '[filesize<1MiB]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'G')\n\n        ydl = YDL({'format': 'all[width>=400][width<=600]'})\n        ydl.process_ie_result(info_dict)\n        downloaded_ids = [info['format_id'] for info in ydl.downloaded_info_dicts]\n        self.assertEqual(downloaded_ids, ['B', 'C', 'D'])\n\n        ydl = YDL({'format': 'best[height<40]'})\n        try:\n            ydl.process_ie_result(info_dict)\n        except ExtractorError:\n            pass\n        self.assertEqual(ydl.downloaded_info_dicts, [])",
        "begin_line": 384,
        "end_line": 449,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.test_subtitles#453",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.test_subtitles(self)",
        "snippet": "    def test_subtitles(self):\n        def s_formats(lang, autocaption=False):\n            return [{\n                'ext': ext,\n                'url': 'http://localhost/video.%s.%s' % (lang, ext),\n                '_auto': autocaption,\n            } for ext in ['vtt', 'srt', 'ass']]\n        subtitles = dict((l, s_formats(l)) for l in ['en', 'fr', 'es'])\n        auto_captions = dict((l, s_formats(l, True)) for l in ['it', 'pt', 'es'])\n        info_dict = {\n            'id': 'test',\n            'title': 'Test',\n            'url': 'http://localhost/video.mp4',\n            'subtitles': subtitles,\n            'automatic_captions': auto_captions,\n            'extractor': 'TEST',\n        }\n\n        def get_info(params={}):\n            params.setdefault('simulate', True)\n            ydl = YDL(params)\n            ydl.report_warning = lambda *args, **kargs: None\n            return ydl.process_video_result(info_dict, download=False)\n\n        result = get_info()\n        self.assertFalse(result.get('requested_subtitles'))\n        self.assertEqual(result['subtitles'], subtitles)\n        self.assertEqual(result['automatic_captions'], auto_captions)\n\n        result = get_info({'writesubtitles': True})\n        subs = result['requested_subtitles']\n        self.assertTrue(subs)\n        self.assertEqual(set(subs.keys()), set(['en']))\n        self.assertTrue(subs['en'].get('data') is None)\n        self.assertEqual(subs['en']['ext'], 'ass')\n\n        result = get_info({'writesubtitles': True, 'subtitlesformat': 'foo/srt'})\n        subs = result['requested_subtitles']\n        self.assertEqual(subs['en']['ext'], 'srt')\n\n        result = get_info({'writesubtitles': True, 'subtitleslangs': ['es', 'fr', 'it']})\n        subs = result['requested_subtitles']\n        self.assertTrue(subs)\n        self.assertEqual(set(subs.keys()), set(['es', 'fr']))\n\n        result = get_info({'writesubtitles': True, 'writeautomaticsub': True, 'subtitleslangs': ['es', 'pt']})\n        subs = result['requested_subtitles']\n        self.assertTrue(subs)\n        self.assertEqual(set(subs.keys()), set(['es', 'pt']))\n        self.assertFalse(subs['es']['_auto'])\n        self.assertTrue(subs['pt']['_auto'])\n\n        result = get_info({'writeautomaticsub': True, 'subtitleslangs': ['es', 'pt']})\n        subs = result['requested_subtitles']\n        self.assertTrue(subs)\n        self.assertEqual(set(subs.keys()), set(['es', 'pt']))\n        self.assertTrue(subs['es']['_auto'])\n        self.assertTrue(subs['pt']['_auto'])",
        "begin_line": 453,
        "end_line": 510,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.s_formats#454",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.s_formats(lang, autocaption=False)",
        "snippet": "        def s_formats(lang, autocaption=False):\n            return [{\n                'ext': ext,\n                'url': 'http://localhost/video.%s.%s' % (lang, ext),\n                '_auto': autocaption,\n            } for ext in ['vtt', 'srt', 'ass']]",
        "begin_line": 454,
        "end_line": 459,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.get_info#471",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.get_info(params={})",
        "snippet": "        def get_info(params={}):\n            params.setdefault('simulate', True)\n            ydl = YDL(params)\n            ydl.report_warning = lambda *args, **kargs: None\n            return ydl.process_video_result(info_dict, download=False)",
        "begin_line": 471,
        "end_line": 475,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.test_add_extra_info#512",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.test_add_extra_info(self)",
        "snippet": "    def test_add_extra_info(self):\n        test_dict = {\n            'extractor': 'Foo',\n        }\n        extra_info = {\n            'extractor': 'Bar',\n            'playlist': 'funny videos',\n        }\n        YDL.add_extra_info(test_dict, extra_info)\n        self.assertEqual(test_dict['extractor'], 'Foo')\n        self.assertEqual(test_dict['playlist'], 'funny videos')",
        "begin_line": 512,
        "end_line": 522,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.test_prepare_filename#524",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.test_prepare_filename(self)",
        "snippet": "    def test_prepare_filename(self):\n        info = {\n            'id': '1234',\n            'ext': 'mp4',\n            'width': None,\n            'height': 1080,\n            'title1': '$PATH',\n            'title2': '%PATH%',\n        }\n\n        def fname(templ):\n            ydl = YoutubeDL({'outtmpl': templ})\n            return ydl.prepare_filename(info)\n        self.assertEqual(fname('%(id)s.%(ext)s'), '1234.mp4')\n        self.assertEqual(fname('%(id)s-%(width)s.%(ext)s'), '1234-NA.mp4')\n        # Replace missing fields with 'NA'\n        self.assertEqual(fname('%(uploader_date)s-%(id)s.%(ext)s'), 'NA-1234.mp4')\n        self.assertEqual(fname('%(height)d.%(ext)s'), '1080.mp4')\n        self.assertEqual(fname('%(height)6d.%(ext)s'), '  1080.mp4')\n        self.assertEqual(fname('%(height)-6d.%(ext)s'), '1080  .mp4')\n        self.assertEqual(fname('%(height)06d.%(ext)s'), '001080.mp4')\n        self.assertEqual(fname('%(height) 06d.%(ext)s'), ' 01080.mp4')\n        self.assertEqual(fname('%(height)   06d.%(ext)s'), ' 01080.mp4')\n        self.assertEqual(fname('%(height)0 6d.%(ext)s'), ' 01080.mp4')\n        self.assertEqual(fname('%(height)0   6d.%(ext)s'), ' 01080.mp4')\n        self.assertEqual(fname('%(height)   0   6d.%(ext)s'), ' 01080.mp4')\n        self.assertEqual(fname('%%'), '%')\n        self.assertEqual(fname('%%%%'), '%%')\n        self.assertEqual(fname('%%(height)06d.%(ext)s'), '%(height)06d.mp4')\n        self.assertEqual(fname('%(width)06d.%(ext)s'), 'NA.mp4')\n        self.assertEqual(fname('%(width)06d.%%(ext)s'), 'NA.%(ext)s')\n        self.assertEqual(fname('%%(width)06d.%(ext)s'), '%(width)06d.mp4')\n        self.assertEqual(fname('Hello %(title1)s'), 'Hello $PATH')\n        self.assertEqual(fname('Hello %(title2)s'), 'Hello %PATH%')",
        "begin_line": 524,
        "end_line": 557,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.fname#534",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.fname(templ)",
        "snippet": "        def fname(templ):\n            ydl = YoutubeDL({'outtmpl': templ})\n            return ydl.prepare_filename(info)",
        "begin_line": 534,
        "end_line": 536,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.test_format_note#559",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.test_format_note(self)",
        "snippet": "    def test_format_note(self):\n        ydl = YoutubeDL()\n        self.assertEqual(ydl._format_note({}), '')\n        assertRegexpMatches(self, ydl._format_note({\n            'vbr': 10,\n        }), r'^\\s*10k$')\n        assertRegexpMatches(self, ydl._format_note({\n            'fps': 30,\n        }), r'^30fps$')",
        "begin_line": 559,
        "end_line": 567,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.test_postprocessors#569",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.test_postprocessors(self)",
        "snippet": "    def test_postprocessors(self):\n        filename = 'post-processor-testfile.mp4'\n        audiofile = filename + '.mp3'\n\n        class SimplePP(PostProcessor):\n            def run(self, info):\n                with open(audiofile, 'wt') as f:\n                    f.write('EXAMPLE')\n                return [info['filepath']], info\n\n        def run_pp(params, PP):\n            with open(filename, 'wt') as f:\n                f.write('EXAMPLE')\n            ydl = YoutubeDL(params)\n            ydl.add_post_processor(PP())\n            ydl.post_process(filename, {'filepath': filename})\n\n        run_pp({'keepvideo': True}, SimplePP)\n        self.assertTrue(os.path.exists(filename), '%s doesn\\'t exist' % filename)\n        self.assertTrue(os.path.exists(audiofile), '%s doesn\\'t exist' % audiofile)\n        os.unlink(filename)\n        os.unlink(audiofile)\n\n        run_pp({'keepvideo': False}, SimplePP)\n        self.assertFalse(os.path.exists(filename), '%s exists' % filename)\n        self.assertTrue(os.path.exists(audiofile), '%s doesn\\'t exist' % audiofile)\n        os.unlink(audiofile)\n\n        class ModifierPP(PostProcessor):\n            def run(self, info):\n                with open(info['filepath'], 'wt') as f:\n                    f.write('MODIFIED')\n                return [], info\n\n        run_pp({'keepvideo': False}, ModifierPP)\n        self.assertTrue(os.path.exists(filename), '%s doesn\\'t exist' % filename)\n        os.unlink(filename)",
        "begin_line": 569,
        "end_line": 605,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.SimplePP.test_postprocessors#569",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.SimplePP",
        "signature": "test.test_YoutubeDL.SimplePP.test_postprocessors(self)",
        "snippet": "    def test_postprocessors(self):\n        filename = 'post-processor-testfile.mp4'\n        audiofile = filename + '.mp3'\n\n        class SimplePP(PostProcessor):\n            def run(self, info):\n                with open(audiofile, 'wt') as f:\n                    f.write('EXAMPLE')\n                return [info['filepath']], info\n\n        def run_pp(params, PP):\n            with open(filename, 'wt') as f:\n                f.write('EXAMPLE')\n            ydl = YoutubeDL(params)\n            ydl.add_post_processor(PP())\n            ydl.post_process(filename, {'filepath': filename})\n\n        run_pp({'keepvideo': True}, SimplePP)\n        self.assertTrue(os.path.exists(filename), '%s doesn\\'t exist' % filename)\n        self.assertTrue(os.path.exists(audiofile), '%s doesn\\'t exist' % audiofile)\n        os.unlink(filename)\n        os.unlink(audiofile)\n\n        run_pp({'keepvideo': False}, SimplePP)\n        self.assertFalse(os.path.exists(filename), '%s exists' % filename)\n        self.assertTrue(os.path.exists(audiofile), '%s doesn\\'t exist' % audiofile)\n        os.unlink(audiofile)\n\n        class ModifierPP(PostProcessor):\n            def run(self, info):\n                with open(info['filepath'], 'wt') as f:\n                    f.write('MODIFIED')\n                return [], info\n\n        run_pp({'keepvideo': False}, ModifierPP)\n        self.assertTrue(os.path.exists(filename), '%s doesn\\'t exist' % filename)\n        os.unlink(filename)",
        "begin_line": 569,
        "end_line": 605,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.SimplePP.run#574",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.SimplePP",
        "signature": "test.test_YoutubeDL.SimplePP.run(self, info)",
        "snippet": "            def run(self, info):\n                with open(audiofile, 'wt') as f:\n                    f.write('EXAMPLE')\n                return [info['filepath']], info",
        "begin_line": 574,
        "end_line": 577,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.run_pp#579",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.run_pp(params, PP)",
        "snippet": "        def run_pp(params, PP):\n            with open(filename, 'wt') as f:\n                f.write('EXAMPLE')\n            ydl = YoutubeDL(params)\n            ydl.add_post_processor(PP())\n            ydl.post_process(filename, {'filepath': filename})",
        "begin_line": 579,
        "end_line": 584,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.ModifierPP.test_postprocessors#569",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.ModifierPP",
        "signature": "test.test_YoutubeDL.ModifierPP.test_postprocessors(self)",
        "snippet": "    def test_postprocessors(self):\n        filename = 'post-processor-testfile.mp4'\n        audiofile = filename + '.mp3'\n\n        class SimplePP(PostProcessor):\n            def run(self, info):\n                with open(audiofile, 'wt') as f:\n                    f.write('EXAMPLE')\n                return [info['filepath']], info\n\n        def run_pp(params, PP):\n            with open(filename, 'wt') as f:\n                f.write('EXAMPLE')\n            ydl = YoutubeDL(params)\n            ydl.add_post_processor(PP())\n            ydl.post_process(filename, {'filepath': filename})\n\n        run_pp({'keepvideo': True}, SimplePP)\n        self.assertTrue(os.path.exists(filename), '%s doesn\\'t exist' % filename)\n        self.assertTrue(os.path.exists(audiofile), '%s doesn\\'t exist' % audiofile)\n        os.unlink(filename)\n        os.unlink(audiofile)\n\n        run_pp({'keepvideo': False}, SimplePP)\n        self.assertFalse(os.path.exists(filename), '%s exists' % filename)\n        self.assertTrue(os.path.exists(audiofile), '%s doesn\\'t exist' % audiofile)\n        os.unlink(audiofile)\n\n        class ModifierPP(PostProcessor):\n            def run(self, info):\n                with open(info['filepath'], 'wt') as f:\n                    f.write('MODIFIED')\n                return [], info\n\n        run_pp({'keepvideo': False}, ModifierPP)\n        self.assertTrue(os.path.exists(filename), '%s doesn\\'t exist' % filename)\n        os.unlink(filename)",
        "begin_line": 569,
        "end_line": 605,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.ModifierPP.run#598",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.ModifierPP",
        "signature": "test.test_YoutubeDL.ModifierPP.run(self, info)",
        "snippet": "            def run(self, info):\n                with open(info['filepath'], 'wt') as f:\n                    f.write('MODIFIED')\n                return [], info",
        "begin_line": 598,
        "end_line": 601,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.test_match_filter#607",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.test_match_filter(self)",
        "snippet": "    def test_match_filter(self):\n        class FilterYDL(YDL):\n            def __init__(self, *args, **kwargs):\n                super(FilterYDL, self).__init__(*args, **kwargs)\n                self.params['simulate'] = True\n\n            def process_info(self, info_dict):\n                super(YDL, self).process_info(info_dict)\n\n            def _match_entry(self, info_dict, incomplete):\n                res = super(FilterYDL, self)._match_entry(info_dict, incomplete)\n                if res is None:\n                    self.downloaded_info_dicts.append(info_dict)\n                return res\n\n        first = {\n            'id': '1',\n            'url': TEST_URL,\n            'title': 'one',\n            'extractor': 'TEST',\n            'duration': 30,\n            'filesize': 10 * 1024,\n            'playlist_id': '42',\n            'uploader': \"\u8b8a\u614b\u598d\u5b57\u5e55\u7248 \u592a\u598d \u0442\u0435\u0441\u0442\",\n            'creator': \"\u0442\u0435\u0441\u0442 ' 123 ' \u0442\u0435\u0441\u0442--\",\n        }\n        second = {\n            'id': '2',\n            'url': TEST_URL,\n            'title': 'two',\n            'extractor': 'TEST',\n            'duration': 10,\n            'description': 'foo',\n            'filesize': 5 * 1024,\n            'playlist_id': '43',\n            'uploader': \"\u0442\u0435\u0441\u0442 123\",\n        }\n        videos = [first, second]\n\n        def get_videos(filter_=None):\n            ydl = FilterYDL({'match_filter': filter_})\n            for v in videos:\n                ydl.process_ie_result(v, download=True)\n            return [v['id'] for v in ydl.downloaded_info_dicts]\n\n        res = get_videos()\n        self.assertEqual(res, ['1', '2'])\n\n        def f(v):\n            if v['id'] == '1':\n                return None\n            else:\n                return 'Video id is not 1'\n        res = get_videos(f)\n        self.assertEqual(res, ['1'])\n\n        f = match_filter_func('duration < 30')\n        res = get_videos(f)\n        self.assertEqual(res, ['2'])\n\n        f = match_filter_func('description = foo')\n        res = get_videos(f)\n        self.assertEqual(res, ['2'])\n\n        f = match_filter_func('description =? foo')\n        res = get_videos(f)\n        self.assertEqual(res, ['1', '2'])\n\n        f = match_filter_func('filesize > 5KiB')\n        res = get_videos(f)\n        self.assertEqual(res, ['1'])\n\n        f = match_filter_func('playlist_id = 42')\n        res = get_videos(f)\n        self.assertEqual(res, ['1'])\n\n        f = match_filter_func('uploader = \"\u8b8a\u614b\u598d\u5b57\u5e55\u7248 \u592a\u598d \u0442\u0435\u0441\u0442\"')\n        res = get_videos(f)\n        self.assertEqual(res, ['1'])\n\n        f = match_filter_func('uploader != \"\u8b8a\u614b\u598d\u5b57\u5e55\u7248 \u592a\u598d \u0442\u0435\u0441\u0442\"')\n        res = get_videos(f)\n        self.assertEqual(res, ['2'])\n\n        f = match_filter_func('creator = \"\u0442\u0435\u0441\u0442 \\' 123 \\' \u0442\u0435\u0441\u0442--\"')\n        res = get_videos(f)\n        self.assertEqual(res, ['1'])\n\n        f = match_filter_func(\"creator = '\u0442\u0435\u0441\u0442 \\\\' 123 \\\\' \u0442\u0435\u0441\u0442--'\")\n        res = get_videos(f)\n        self.assertEqual(res, ['1'])\n\n        f = match_filter_func(r\"creator = '\u0442\u0435\u0441\u0442 \\' 123 \\' \u0442\u0435\u0441\u0442--' & duration > 30\")\n        res = get_videos(f)\n        self.assertEqual(res, [])",
        "begin_line": 607,
        "end_line": 701,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.FilterYDL.test_match_filter#607",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.FilterYDL",
        "signature": "test.test_YoutubeDL.FilterYDL.test_match_filter(self)",
        "snippet": "    def test_match_filter(self):\n        class FilterYDL(YDL):\n            def __init__(self, *args, **kwargs):\n                super(FilterYDL, self).__init__(*args, **kwargs)\n                self.params['simulate'] = True\n\n            def process_info(self, info_dict):\n                super(YDL, self).process_info(info_dict)\n\n            def _match_entry(self, info_dict, incomplete):\n                res = super(FilterYDL, self)._match_entry(info_dict, incomplete)\n                if res is None:\n                    self.downloaded_info_dicts.append(info_dict)\n                return res\n\n        first = {\n            'id': '1',\n            'url': TEST_URL,\n            'title': 'one',\n            'extractor': 'TEST',\n            'duration': 30,\n            'filesize': 10 * 1024,\n            'playlist_id': '42',\n            'uploader': \"\u8b8a\u614b\u598d\u5b57\u5e55\u7248 \u592a\u598d \u0442\u0435\u0441\u0442\",\n            'creator': \"\u0442\u0435\u0441\u0442 ' 123 ' \u0442\u0435\u0441\u0442--\",\n        }\n        second = {\n            'id': '2',\n            'url': TEST_URL,\n            'title': 'two',\n            'extractor': 'TEST',\n            'duration': 10,\n            'description': 'foo',\n            'filesize': 5 * 1024,\n            'playlist_id': '43',\n            'uploader': \"\u0442\u0435\u0441\u0442 123\",\n        }\n        videos = [first, second]\n\n        def get_videos(filter_=None):\n            ydl = FilterYDL({'match_filter': filter_})\n            for v in videos:\n                ydl.process_ie_result(v, download=True)\n            return [v['id'] for v in ydl.downloaded_info_dicts]\n\n        res = get_videos()\n        self.assertEqual(res, ['1', '2'])\n\n        def f(v):\n            if v['id'] == '1':\n                return None\n            else:\n                return 'Video id is not 1'\n        res = get_videos(f)\n        self.assertEqual(res, ['1'])\n\n        f = match_filter_func('duration < 30')\n        res = get_videos(f)\n        self.assertEqual(res, ['2'])\n\n        f = match_filter_func('description = foo')\n        res = get_videos(f)\n        self.assertEqual(res, ['2'])\n\n        f = match_filter_func('description =? foo')\n        res = get_videos(f)\n        self.assertEqual(res, ['1', '2'])\n\n        f = match_filter_func('filesize > 5KiB')\n        res = get_videos(f)\n        self.assertEqual(res, ['1'])\n\n        f = match_filter_func('playlist_id = 42')\n        res = get_videos(f)\n        self.assertEqual(res, ['1'])\n\n        f = match_filter_func('uploader = \"\u8b8a\u614b\u598d\u5b57\u5e55\u7248 \u592a\u598d \u0442\u0435\u0441\u0442\"')\n        res = get_videos(f)\n        self.assertEqual(res, ['1'])\n\n        f = match_filter_func('uploader != \"\u8b8a\u614b\u598d\u5b57\u5e55\u7248 \u592a\u598d \u0442\u0435\u0441\u0442\"')\n        res = get_videos(f)\n        self.assertEqual(res, ['2'])\n\n        f = match_filter_func('creator = \"\u0442\u0435\u0441\u0442 \\' 123 \\' \u0442\u0435\u0441\u0442--\"')\n        res = get_videos(f)\n        self.assertEqual(res, ['1'])\n\n        f = match_filter_func(\"creator = '\u0442\u0435\u0441\u0442 \\\\' 123 \\\\' \u0442\u0435\u0441\u0442--'\")\n        res = get_videos(f)\n        self.assertEqual(res, ['1'])\n\n        f = match_filter_func(r\"creator = '\u0442\u0435\u0441\u0442 \\' 123 \\' \u0442\u0435\u0441\u0442--' & duration > 30\")\n        res = get_videos(f)\n        self.assertEqual(res, [])",
        "begin_line": 607,
        "end_line": 701,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.FilterYDL.__init__#609",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.FilterYDL",
        "signature": "test.test_YoutubeDL.FilterYDL.__init__(self, *args, **kwargs)",
        "snippet": "            def __init__(self, *args, **kwargs):\n                super(FilterYDL, self).__init__(*args, **kwargs)\n                self.params['simulate'] = True",
        "begin_line": 609,
        "end_line": 611,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.FilterYDL.process_info#613",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.FilterYDL",
        "signature": "test.test_YoutubeDL.FilterYDL.process_info(self, info_dict)",
        "snippet": "            def process_info(self, info_dict):\n                super(YDL, self).process_info(info_dict)",
        "begin_line": 613,
        "end_line": 614,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.FilterYDL._match_entry#616",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.FilterYDL",
        "signature": "test.test_YoutubeDL.FilterYDL._match_entry(self, info_dict, incomplete)",
        "snippet": "            def _match_entry(self, info_dict, incomplete):\n                res = super(FilterYDL, self)._match_entry(info_dict, incomplete)\n                if res is None:\n                    self.downloaded_info_dicts.append(info_dict)\n                return res",
        "begin_line": 616,
        "end_line": 620,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.get_videos#646",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.get_videos(filter_=None)",
        "snippet": "        def get_videos(filter_=None):\n            ydl = FilterYDL({'match_filter': filter_})\n            for v in videos:\n                ydl.process_ie_result(v, download=True)\n            return [v['id'] for v in ydl.downloaded_info_dicts]",
        "begin_line": 646,
        "end_line": 650,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.f#655",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.f(v)",
        "snippet": "        def f(v):\n            if v['id'] == '1':\n                return None\n            else:\n                return 'Video id is not 1'",
        "begin_line": 655,
        "end_line": 659,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.test_playlist_items_selection#703",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.test_playlist_items_selection(self)",
        "snippet": "    def test_playlist_items_selection(self):\n        entries = [{\n            'id': compat_str(i),\n            'title': compat_str(i),\n            'url': TEST_URL,\n        } for i in range(1, 5)]\n        playlist = {\n            '_type': 'playlist',\n            'id': 'test',\n            'entries': entries,\n            'extractor': 'test:playlist',\n            'extractor_key': 'test:playlist',\n            'webpage_url': 'http://example.com',\n        }\n\n        def get_ids(params):\n            ydl = YDL(params)\n            # make a copy because the dictionary can be modified\n            ydl.process_ie_result(playlist.copy())\n            return [int(v['id']) for v in ydl.downloaded_info_dicts]\n\n        result = get_ids({})\n        self.assertEqual(result, [1, 2, 3, 4])\n\n        result = get_ids({'playlistend': 10})\n        self.assertEqual(result, [1, 2, 3, 4])\n\n        result = get_ids({'playlistend': 2})\n        self.assertEqual(result, [1, 2])\n\n        result = get_ids({'playliststart': 10})\n        self.assertEqual(result, [])\n\n        result = get_ids({'playliststart': 2})\n        self.assertEqual(result, [2, 3, 4])\n\n        result = get_ids({'playlist_items': '2-4'})\n        self.assertEqual(result, [2, 3, 4])\n\n        result = get_ids({'playlist_items': '2,4'})\n        self.assertEqual(result, [2, 4])\n\n        result = get_ids({'playlist_items': '10'})\n        self.assertEqual(result, [])",
        "begin_line": 703,
        "end_line": 746,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.get_ids#718",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.get_ids(params)",
        "snippet": "        def get_ids(params):\n            ydl = YDL(params)\n            # make a copy because the dictionary can be modified\n            ydl.process_ie_result(playlist.copy())\n            return [int(v['id']) for v in ydl.downloaded_info_dicts]",
        "begin_line": 718,
        "end_line": 722,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.test_urlopen_no_file_protocol#748",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.test_urlopen_no_file_protocol(self)",
        "snippet": "    def test_urlopen_no_file_protocol(self):\n        # see https://github.com/rg3/youtube-dl/issues/8227\n        ydl = YDL()\n        self.assertRaises(compat_urllib_error.URLError, ydl.urlopen, 'file:///etc/passwd')",
        "begin_line": 748,
        "end_line": 751,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.TestYoutubeDL.test_do_not_override_ie_key_in_url_transparent#753",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.TestYoutubeDL",
        "signature": "test.test_YoutubeDL.TestYoutubeDL.test_do_not_override_ie_key_in_url_transparent(self)",
        "snippet": "    def test_do_not_override_ie_key_in_url_transparent(self):\n        ydl = YDL()\n\n        class Foo1IE(InfoExtractor):\n            _VALID_URL = r'foo1:'\n\n            def _real_extract(self, url):\n                return {\n                    '_type': 'url_transparent',\n                    'url': 'foo2:',\n                    'ie_key': 'Foo2',\n                    'title': 'foo1 title'\n                }\n\n        class Foo2IE(InfoExtractor):\n            _VALID_URL = r'foo2:'\n\n            def _real_extract(self, url):\n                return {\n                    '_type': 'url',\n                    'url': 'foo3:',\n                    'ie_key': 'Foo3',\n                }\n\n        class Foo3IE(InfoExtractor):\n            _VALID_URL = r'foo3:'\n\n            def _real_extract(self, url):\n                return _make_result([{'url': TEST_URL}], title='foo3 title')\n\n        ydl.add_info_extractor(Foo1IE(ydl))\n        ydl.add_info_extractor(Foo2IE(ydl))\n        ydl.add_info_extractor(Foo3IE(ydl))\n        ydl.extract_info('foo1:')\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['url'], TEST_URL)\n        self.assertEqual(downloaded['title'], 'foo1 title')",
        "begin_line": 753,
        "end_line": 789,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.Foo1IE.test_do_not_override_ie_key_in_url_transparent#753",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.Foo1IE",
        "signature": "test.test_YoutubeDL.Foo1IE.test_do_not_override_ie_key_in_url_transparent(self)",
        "snippet": "    def test_do_not_override_ie_key_in_url_transparent(self):\n        ydl = YDL()\n\n        class Foo1IE(InfoExtractor):\n            _VALID_URL = r'foo1:'\n\n            def _real_extract(self, url):\n                return {\n                    '_type': 'url_transparent',\n                    'url': 'foo2:',\n                    'ie_key': 'Foo2',\n                    'title': 'foo1 title'\n                }\n\n        class Foo2IE(InfoExtractor):\n            _VALID_URL = r'foo2:'\n\n            def _real_extract(self, url):\n                return {\n                    '_type': 'url',\n                    'url': 'foo3:',\n                    'ie_key': 'Foo3',\n                }\n\n        class Foo3IE(InfoExtractor):\n            _VALID_URL = r'foo3:'\n\n            def _real_extract(self, url):\n                return _make_result([{'url': TEST_URL}], title='foo3 title')\n\n        ydl.add_info_extractor(Foo1IE(ydl))\n        ydl.add_info_extractor(Foo2IE(ydl))\n        ydl.add_info_extractor(Foo3IE(ydl))\n        ydl.extract_info('foo1:')\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['url'], TEST_URL)\n        self.assertEqual(downloaded['title'], 'foo1 title')",
        "begin_line": 753,
        "end_line": 789,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.Foo1IE._real_extract#759",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.Foo1IE",
        "signature": "test.test_YoutubeDL.Foo1IE._real_extract(self, url)",
        "snippet": "            def _real_extract(self, url):\n                return {\n                    '_type': 'url_transparent',\n                    'url': 'foo2:',\n                    'ie_key': 'Foo2',\n                    'title': 'foo1 title'\n                }",
        "begin_line": 759,
        "end_line": 765,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.Foo2IE.test_do_not_override_ie_key_in_url_transparent#753",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.Foo2IE",
        "signature": "test.test_YoutubeDL.Foo2IE.test_do_not_override_ie_key_in_url_transparent(self)",
        "snippet": "    def test_do_not_override_ie_key_in_url_transparent(self):\n        ydl = YDL()\n\n        class Foo1IE(InfoExtractor):\n            _VALID_URL = r'foo1:'\n\n            def _real_extract(self, url):\n                return {\n                    '_type': 'url_transparent',\n                    'url': 'foo2:',\n                    'ie_key': 'Foo2',\n                    'title': 'foo1 title'\n                }\n\n        class Foo2IE(InfoExtractor):\n            _VALID_URL = r'foo2:'\n\n            def _real_extract(self, url):\n                return {\n                    '_type': 'url',\n                    'url': 'foo3:',\n                    'ie_key': 'Foo3',\n                }\n\n        class Foo3IE(InfoExtractor):\n            _VALID_URL = r'foo3:'\n\n            def _real_extract(self, url):\n                return _make_result([{'url': TEST_URL}], title='foo3 title')\n\n        ydl.add_info_extractor(Foo1IE(ydl))\n        ydl.add_info_extractor(Foo2IE(ydl))\n        ydl.add_info_extractor(Foo3IE(ydl))\n        ydl.extract_info('foo1:')\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['url'], TEST_URL)\n        self.assertEqual(downloaded['title'], 'foo1 title')",
        "begin_line": 753,
        "end_line": 789,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.Foo2IE._real_extract#770",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.Foo2IE",
        "signature": "test.test_YoutubeDL.Foo2IE._real_extract(self, url)",
        "snippet": "            def _real_extract(self, url):\n                return {\n                    '_type': 'url',\n                    'url': 'foo3:',\n                    'ie_key': 'Foo3',\n                }",
        "begin_line": 770,
        "end_line": 775,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.Foo3IE.test_do_not_override_ie_key_in_url_transparent#753",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.Foo3IE",
        "signature": "test.test_YoutubeDL.Foo3IE.test_do_not_override_ie_key_in_url_transparent(self)",
        "snippet": "    def test_do_not_override_ie_key_in_url_transparent(self):\n        ydl = YDL()\n\n        class Foo1IE(InfoExtractor):\n            _VALID_URL = r'foo1:'\n\n            def _real_extract(self, url):\n                return {\n                    '_type': 'url_transparent',\n                    'url': 'foo2:',\n                    'ie_key': 'Foo2',\n                    'title': 'foo1 title'\n                }\n\n        class Foo2IE(InfoExtractor):\n            _VALID_URL = r'foo2:'\n\n            def _real_extract(self, url):\n                return {\n                    '_type': 'url',\n                    'url': 'foo3:',\n                    'ie_key': 'Foo3',\n                }\n\n        class Foo3IE(InfoExtractor):\n            _VALID_URL = r'foo3:'\n\n            def _real_extract(self, url):\n                return _make_result([{'url': TEST_URL}], title='foo3 title')\n\n        ydl.add_info_extractor(Foo1IE(ydl))\n        ydl.add_info_extractor(Foo2IE(ydl))\n        ydl.add_info_extractor(Foo3IE(ydl))\n        ydl.extract_info('foo1:')\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['url'], TEST_URL)\n        self.assertEqual(downloaded['title'], 'foo1 title')",
        "begin_line": 753,
        "end_line": 789,
        "comment": "",
        "is_bug": false
    },
    {
        "name": "test.test_YoutubeDL.Foo3IE._real_extract#780",
        "src_path": "test/test_YoutubeDL.py",
        "class_name": "test.test_YoutubeDL.Foo3IE",
        "signature": "test.test_YoutubeDL.Foo3IE._real_extract(self, url)",
        "snippet": "            def _real_extract(self, url):\n                return _make_result([{'url': TEST_URL}], title='foo3 title')",
        "begin_line": 780,
        "end_line": 781,
        "comment": "",
        "is_bug": false
    }
]